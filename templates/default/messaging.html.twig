{% extends 'base_front.html.twig' %}

{% block title %}Messagerie{% endblock %}

{% block body %}

    <h1 class="display-4 mt-5">Messagerie</h1>

    <!--MAIN-->
    <div class="container mx-auto mb-5 pt-4 mt-4" id="bloc_page_messaging">
        <div class="row">

            <div class="col-lg-5 col-sm-12 ml-lg-5 ml-sm-0 pb-4">   
                <!--Bloc contenant la liste des contactes-->
                <div class="col-12 bloc_list_contact pt-3 mt-3">
                    {#<h2>Liste des contacts</h2>#}
                    <!--Bloc contact-->
                    {% for c in conversations %}
                        <div class="bloc_contact mt-3 mx-auto {% if conversationSelected is defined and conversationSelected is not null and c.id == conversationSelected.id %} bloc_contact_selected {% endif %}">
                            {{ c.customRequest.title }}
                            <a href="{{ path('messagingPageConversation', {id: c.id}) }}">
                                <img  class="conversation_image" src="{{ asset('uploads/customRequestPictures/' ~ c.customRequest.photoPath) }}" alt="photo de l'objet à customiser" class="img-responsive">
                            </a>
                        </div>
                    {%  endfor %}
                </div>
            </div>

            <div class="col-lg-6 col-sm-12 pb-4">
                <!--Bloc de la liste des messages-->
                <div class="col-12 bloc_list_message pt-3 mt-3">
                    {#<h2>Liste des messages</h2>#}
                    <!--Bloc message-->
                    <div class="bloc_message mt-3 mx-auto">
                        <!--Bannière message-->
                        {% if conversationSelected is defined and conversationSelected is not null and conversationSelected.messages is defined and conversationSelected.messages is not null %}
                            {% for m in conversationSelected.messages %}
                                <div class="container-fluid bg-white message_banner {% if m.author.id == app.user.id %} message_sent {% else %} message_received {% endif %}">
                                    {#<span class="interlocutor">Interlocuteur</span>#}
                                    {{ m.creationDate|date("d/m/Y H:i") }}
                                </div>
                                <!--Message-->
                                <div>
                                    <p class="pt-3 ">
                                        <p class="{% if m.author.id == app.user.id %} message_sent {% else %} message_received {% endif %}">{{ m.content }}</p>
                                    </p>
                                </div>
                            {%  endfor %}
                        {% endif %}

                        <div class="container-fluid mt-5">
                            <form method="POST">
                                {# {{ form(formMessage) }} #}
                            </form>
                        </div>
                    </div>
                    <!--Bloc message-->
                    <div class="bloc_message mt-3 mx-auto">
                        <div class="container-fluid mt-5">
                            <div>
                                <textarea class="form-control" id="message_response" rows="2"></textarea>
                            </div>
                            <div>
                                <button type="button" class="btn btn-info btn-sm mt-3" id="sending_message_button">Envoyer</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <P class="pb-4" id="my_space_link">
            <a href="#" class="badge badge-pill badge-dark p-3">Retour à l'espace personnel</a>
        </p>
    </div>

{% endblock %}
