{% extends 'base_front.html.twig' %}

{% block title %}Accueil{% endblock %}

{% block body %}
    <div class="banner container-fluid">

    <h1 class="pb-3 pt-3">Faites de VOS objets du quotidien des pièces uniques</h1>

        {#{{ form_start(formSearch) }}#}
        <form class="form-row d-flex justify-content-center" action="" method="post">
            <div class="col-sm-8 col-md-2 mt-1 ml-4 ml-sm-0 offset-sm-1 offset-md-2 " id="category_select">
                {{ form_row(formSearch.category_id) }}
            </div>
            <div class="col-sm-8  col-md-2 offset-md-0 mt-1 ml-4 ml-sm-0 ">
                <input class="form-control" type="text" name="search" placeholder="Recherche">
            </div>

            <div class="col-sm-8 col-md-2 offset-md-0 mt-1 ml-4 ml-sm-0">
                <input class="form-control" type="text" name="city" placeholder="Ville">
            </div>

            <div class="col-sm-8 offset-sm-2 col-md-2 offset-md-0 mt-1 ml-4 ml-sm-0">
                <input class="form-control" type="text" name="zipcode" placeholder="Code postal">
            </div>

            <div class="col-sm-8 col-md-12 mt-md-4 mt-1">
                <button class="btn" type="submit" id="search_submit">Trouver un customiseur !</button>
                {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                    <a href="{{ path('custom_request_create') }}" class="btn mt-1" role="button" id="link_new_customrequest" aria-pressed="true">Poster une demande de customisation</a>
                {% endif %}

            </div>

        </form>

    </div>

    <!--Block affichant le résultat de la recherche ajax-->
    <div class="card-deck d-flex justify-content-center mx-auto no-gutter" id="search_result">
                       
    </div>
    <!--Fin du block affichant le résultat de la recherche ajax-->

    <div class="container-fluid pb-5">
        <div class="row darkgreyzone pt-5 pb-5" id="sub_banner">
            <div class="col-12">
                <h2>La personnalisation d'objets, c'est <span class="OCO">OuiCustOm</span></h2>
                <h6>Mise en relation de particuliers à customiseurs pour personnaliser des objets</h6>
                <h5 class="pt-2"><span class="OCO">OuiCustOm </span>c'est :</h5>
            </div>
        </div>

        <div class="icones row pt-5 pb-5">
            <div class="col-sm-12 col-md-4 pt-sm-4">
                <i class="fas fas fa-search fa-5x"></i><br>
                <h2 class="pt-3 text-dark">Un service de proximité</h2>
                <div class="d-flex justify-content-center pt-2">
                    <h5 class="col-8  justify-content-center">Faite une recherche et trouvez des Customiseurs proches de chez vous...</h5>
                </div>
            </div>

            <div class="col-sm-12 col-md-4 pt-sm-4">
                <i class="fas fa-address-card fa-5x"></i><br>
                <h2 class="pt-3 text-dark">Des Customiseurs de qualité</h2>
                <div class="d-flex justify-content-center pt-2">
                    <h5 class="col-8  justify-content-center">Découvrez nos nombreux Customiseurs et leurs univers, visitez leurs galeries, déposez vos demandes</h5>
                </div>
            </div>

            <div class="col-sm-12 col-md-4 pt-sm-4">
                <i class="fas fa-thumbs-up fa-5x"></i><br>
                <h2 class="pt-3 text-dark">Des créations uniques</h2>
                <div class="d-flex justify-content-center pt-2">
                    <h5 class="col-8  justify-content-center"> Prenez directement contact avec le Customiseur de votre choix et donnez une seconde vie à vos objets</h5>
                </div>
            </div>
        </div>

        <div class="row darkgreyzone d-flex justify-content-center pt-5 pb-5">
            <p class="col-12 mb-5">Que vous soyez à la recherche du Customiseur idéal, <br> Customiseur en herbe ou confirmé...</p>
            <a href="{{path('registrationPage')}}" class="col-sm-12 col-md-4 btn btn_register_home texte-white" role="button" aria-pressed="true">Inscrivez-vous</a>
        </div>   
        
        
        <h3 class="left text-center mt-3 mb-3"> Mise en lumière</h5>


        <div class="container">

            <div class="row  d-flex align-items-center">
                 {# Modal  de l'image 1#}
                <div class="modal fade" id="img0" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">@guitare_color</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <img src="{{ asset('uploads/gallery/55ed478293d364a752438761e6f19f5a.jpeg')  }}" class="img-thumbnail" alt="Responsive image" >
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>                       
                            </div>
                        </div>
                    </div>
                </div>

                 {# Modal  de l'image 2#}
                <div class="modal fade" id="img1" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">@gold&blue</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <img src="{{ asset('uploads/gallery/c0b55559de14a538e27d77318036d989.jpeg')  }}" class="img-thumbnail" alt="Responsive image" >
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>                       
                            </div>
                        </div>
                    </div>
                </div>

                 {# Modal  de l'image 3#}
                <div class="modal fade" id="img2" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">@total_blue</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <img src="{{ asset('uploads/gallery/b21ff336d0ba2abe35cad01de918ea3a.jpeg')  }}" class="img-thumbnail" alt="Responsive image" >
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>                       
                            </div>
                        </div>
                    </div>
                </div>

                 {# Modal  de l'image 4#}
                <div class="modal fade" id="img3" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">@pink_floyd</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <img src="{{ asset('uploads/gallery/2d42547ef17ddf7e822669d024b51766.jpeg')  }}" class="img-thumbnail" alt="Responsive image" >
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>                       
                            </div>
                        </div>
                    </div>
                </div>
                {# image de la mise en lumiere #}
                <div class="col-sm-12 col-md-8 ">
                    <img src="{{ asset('uploads/gallery/55ed478293d364a752438761e6f19f5a.jpeg') | imagine_filter('my_thumb') }}" class="mt-2  col-sm-5 col-md-5 img-thumbnail img0" data-toggle="modal" data-target="#img0">
                    <img src="{{ asset('uploads/gallery/c0b55559de14a538e27d77318036d989.jpeg') | imagine_filter('my_thumb') }}" class="mt-2  col-sm-5 col-md-5 img-thumbnail img1" data-toggle="modal" data-target="#img1">
                    <img src="{{ asset('uploads/gallery/b21ff336d0ba2abe35cad01de918ea3a.jpeg') | imagine_filter('my_thumb') }}" class="mt-2  col-sm-5 col-md-5 img-thumbnail img2" data-toggle="modal" data-target="#img2">
                    <img src="{{ asset('uploads/gallery/2d42547ef17ddf7e822669d024b51766.jpeg') | imagine_filter('my_thumb') }}" class="mt-2  col-sm-5 col-md-5 img-thumbnail img3" data-toggle="modal" data-target="#img3">
                </div>  
                    
             {# Devrait recupere les info et photo des customiseur #}

                <div class="col-12 col-md-4  mt-5 mt-md-0 d-flex justify-content-center align-items-center">
                    <div class="card mt-6 " style="width: 18rem;">
                        <img src="{{ asset('uploads/profilPictures/customer1.jpg') | imagine_filter('my_thumb') }}" class =" img-thumbnail " >
                        <div class="card-body">
                            <h5 class="card-title">@LezART</h5>
                            <p class="card-text">est un customisateur née en 1990 à Bayonne. ses illustrations sont drôles, dynamiques et modernes.... étrange et expressif. Mais ce sont les deux faces de la même pièce..</p>
                        </div>
                        <ul class="list-group list-group-flush" id="list">
                            <li class="list-group-item "> <a href="{# {{path('registrationPage')}} #}" class="col-sm-12 col-md-12 btn texte-white" role="button" aria-pressed="true">Decouvrir ce Customiseur </a></li>                     
                        </ul>
                        
                    </div>
                </div>
            </div>

    
   

    <script
        src="https://code.jquery.com/jquery-3.3.1.js"
        integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
        crossorigin="anonymous">
    </script>

    <script>
        //Permet de supprimer la sous-bannière et de mettre le resultat de la recherche à la place sur click du boutton submit
        $('#search_submit').click(function() {

            $("#sub_banner").addClass("none");
            $("#search_result").addClass("mt-4");
            $("#search_result").addClass("mb-4");
		})

    </script>

    <script type="text/javascript">
        //Requête ajax permettant la recherche 
        $(document).ready(function(){
            $('form').submit(function(e){
                
                e.preventDefault();

                $.ajax({
                    url: '{{ path("ajaxHandle") }}',
                    type: 'post',
                    data: $(this).serialize(),
                    
                    dataType: 'json', 
                    success: function(resultJSON){

                        console.log(resultJSON);
                        $output = '';

                        if(resultJSON == null || resultJSON == '')
                        {
                            $output += '<p>Aucun artisan ne correspond à votre recherche</p>';
                        }
                        else
                        {
                            $.each(resultJSON, function (id, element) {

                                if(element.description == null)
                                {
                                    $output += '<div class="card" id="search_card" style="max-width: 200px;">' +
                                    '<img class="card-img-top" src="/uploads/profilPictures/' + element.profilPicture + '" alt="Card image cap">' +
                                    '<div class="card-body">' +
                                    '<h5 class="card-title">' + element.username + '</h5>' +
                                    '<p class="card-text text-truncate"> Champ non renseigné </p>' +
                                    '<a href="/default/profildetail/' + element.id + '" class="btn btn-primary">Voir profil</a>' +
                                    '</div>' +
                                    '</div>';
                                } 
                                else {

                                    $output += '<div class="card" id="search_card" style="max-width: 200px;">' +
                                    '<img class="card-img-top" src="/uploads/profilPictures/' + element.profilPicture + '" alt="Card image cap">' +
                                    '<div class="card-body">' +
                                    '<h5 class="card-title">' + element.username + '</h5>' +
                                    '<p class="card-text text-truncate">' + element.description + '</p>' +
                                    '<a href="/default/profildetail/' + element.id + '" class="btn btn-primary">Voir profil</a>' +
                                    '</div>' +
                                    '</div>';
                                    }

                                });
                        }
                        
                        $('#search_result').html($output);
                        
                    }
                });
            });
        });
    </script>

{% endblock %}